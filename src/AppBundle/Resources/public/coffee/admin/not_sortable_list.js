// Generated by CoffeeScript 1.12.7
var $addItemLink, $collectionHolder, addItemLink;

$addItemLink = $("<a href=\"#\" class=\"add_item_link btn btn-default col-sm-offset-2\">Add " + itemType + "</a>");

$collectionHolder = null;

jQuery(document).ready(function() {
  $collectionHolder = $('ul.mutable-items');
  $collectionHolder.after($addItemLink);
  $collectionHolder.data('index', $collectionHolder.find(".list-item").length);
  $addItemLink.on('click', function(e) {
    e.preventDefault();
    return addItemLink($collectionHolder);
  });
  $collectionHolder.find('li.list-item').each(function() {
    return addAllActionLinks($(this));
  });
  return $("#edit-" + itemType + "s").on('submit', function(event) {
    event.preventDefault();
    $collectionHolder.find("li.list-item ." + itemType + "-position").each(function(index) {
      return $(this).val(index);
    });
    return $(this).unbind('submit').submit();
  });
});

addItemLink = function($collectionHolder) {
  var $newFormLi, index, newForm, prototype;
  prototype = $collectionHolder.data('prototype');
  index = $collectionHolder.data('index');
  newForm = prototype.replace(/__name__/g, index);
  $collectionHolder.data('index', index + 1);
  $newFormLi = $('<li class="list-item new-item"></li>').append(newForm);
  $collectionHolder.append($newFormLi);
  return addAllActionLinks($newFormLi);
};
