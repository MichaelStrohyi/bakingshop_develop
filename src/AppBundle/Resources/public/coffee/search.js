// Generated by CoffeeScript 1.12.7
var globalTimeout, search_str;

search_str = '';

globalTimeout = null;

$(function() {
  $('.search-input').bind("input", function() {
    var el;
    if (globalTimeout !== null) {
      clearTimeout(globalTimeout);
    }
    el = this;
    if (el.value === search_str) {
      return;
    }
    return globalTimeout = setTimeout(function() {
      var ajax_url;
      globalTimeout = null;
      search_str = el.value;
      $(".top-menu-search-result").html('').hide();
      if (search_str.length >= 2) {
        $(".top-menu-search-image").hide();
        $(".top-menu-search-loading").show();
        if (fa) {
          ajax_url = "/search?a=a";
        } else {
          ajax_url = "/search";
        }
        return $.ajax({
          type: 'post',
          url: ajax_url,
          data: {
            'search-ajax': search_str
          },
          response: 'text',
          error: function() {
            $(".top-menu-search-loading").hide();
            return $(".top-menu-search-image").show();
          },
          success: function(data) {
            if (data) {
              $(".top-menu-search-result").html(data).fadeIn();
              $(".top-menu-search-loading").hide();
              return $(".top-menu-search-image").show();
            }
          }
        });
      }
    }, 1000);
  });
  $(".top-menu-search-result").hover(function() {
    return $(".search-input").blur();
  });
  $(".top-menu-search-result").on("mouseenter", "a", function() {
    var s_res;
    s_res = $(this).text();
    if ($(this).hasClass("search-result-more")) {
      return $(".search-input").val(search_str);
    } else {
      $(".search-input").val(s_res);
      return search_str = s_res;
    }
  });
  $(".top-menu-search-form").on("mouseleave", function() {
    return window.setTimeout(function() {
      return $(".top-menu-search-result").fadeOut("fast");
    }, 600);
  });
  return $(".top-menu-search-form").on("mouseenter", function() {
    if ($.trim($(".top-menu-search-result").text()) !== '') {
      return $(".top-menu-search-result").fadeIn("fast");
    }
  });
});
